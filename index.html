<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BLACKPINK Player Bridge</title>
    <style>
        /* Ensures the player fills the entire screen area of the APK's iframe */
        body, html { 
            margin: 0; 
            padding: 0; 
            width: 100%; 
            height: 100%; 
            background: #000; 
            overflow: hidden; 
        }
        #player { 
            width: 100%; 
            height: 100%; 
        }
    </style>
</head>
<body>
    <div id="player"></div>

    <script>
        // 1. Get parameters sent from the APK (e.g., ?v=VIDEO_ID or ?list=PLAYLIST_ID)
        const urlParams = new URLSearchParams(window.location.search);
        const videoId = urlParams.get('v');
        const listId = urlParams.get('list');

        // 2. Load the official YouTube IFrame Player API
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        // 3. This function runs automatically when the API is ready
        var player;
        function onYouTubeIframeAPIReady() {
            let playerConfig = {
                height: '100%',
                width: '100%',
                playerVars: { 
                    'autoplay': 1,        // Auto-start the video
                    'playsinline': 1,     // Keep video inside the app (no full-screen jump)
                    'rel': 0,             // Don't show related videos from other channels
                    'modestbranding': 1,  // Hide the YouTube logo as much as possible
                    'origin': window.location.origin 
                },
                events: { 
                    'onReady': onPlayerReady,
                    'onError': onPlayerError
                }
            };

            // 4. Determine if we are playing a single video or a playlist
            if (listId) {
                playerConfig.playerVars.listType = 'playlist';
                playerConfig.playerVars.list = listId;
            } else if (videoId) {
                playerConfig.videoId = videoId;
            } else {
                console.error("No Video or Playlist ID provided.");
                return;
            }

            player = new YT.Player('player', playerConfig);
        }

        // 5. Force play when ready (sometimes needed for mobile WebView)
        function onPlayerReady(event) {
            event.target.playVideo();
        }

        function onPlayerError(event) {
            console.error("YouTube Player Error:", event.data);
        }
    </script>
</body>
</html>
